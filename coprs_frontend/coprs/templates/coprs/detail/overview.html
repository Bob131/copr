{% extends "coprs/detail.html" %}

{% from "coprs/_coprs_forms.html" import copr_legal_flag_form with context %}

{% block overview_selected %}selected{% endblock %}

{% block detail_body %}
  <h2>Description</h2>
  <div class="shift-right">{{ copr.description_or_not_filled }}</div>
  <h2>Installation Instructions</h2>
  <div class="shift-right">{{ copr.instructions_or_not_filled}}</div>
  <h2>Active Releases</h2>
  <table class="releases">
    <tr>
      <th class="leftmost">Release</th>
      <th class="rightmost">Architecture</th>
    </tr>
    {% for mock_chroot in copr.active_mock_chroots %}
      {% if loop.index < copr.active_mock_chroots|length %}
        {% if mock_chroot.os_release != copr.active_mock_chroots[loop.index].os_release or
              mock_chroot.os_version != copr.active_mock_chroots[loop.index].os_version %}
          {# next release is different => release-end #}
          <tr class="release-end">
        {% else %}
          <tr>
        {% endif %}
      {% else %}{# last line => release-end for sure #}
        <tr class="release-end">
      {% endif %}
        {% if mock_chroot.os_release != copr.active_mock_chroots[loop.index0 - 1].os_release or
	      mock_chroot.os_version != copr.active_mock_chroots[loop.index0 - 1].os_version or
	      loop.index0 == 0 %}
          {# previous os_release-os_version were different or this is the first one #}
          <td>{{ mock_chroot.os_release|capitalize }} {{ mock_chroot.os_version }}</td>
        {% else %}
          <td></td>
        {% endif %}
      <td>{{ mock_chroot.arch }}</td>
      </tr>
    {% else %}
      <tr colspan="2"><td>No active releases</td></tr>
    {% endfor %}
  </table>
  {% if copr.repos_list %}
    <h2>Repository List</h2>
    <ul class=repos-list>
      {% for repo in copr.repos_list %}
        <li><a href="{{ repo }}">{{ repo }}</a></li>
      {% endfor %}
    </ul>  
  {% endif %}

  <hr>
  {{ copr_legal_flag_form(form, copr) }}
{% endblock %}
